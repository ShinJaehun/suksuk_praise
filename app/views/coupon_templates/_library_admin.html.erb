<div class="mb-3 flex items-center justify-between">
  <h2 class="text-lg font-semibold"><%= t("coupon_templates.library.admin_title", default: "ë¼ì´ë¸ŒëŸ¬ë¦¬(ê´€ë¦¬ìž)") %></h2>

  <%# âœ… ê´€ë¦¬ìž: ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ìƒˆë¡œ ë§Œë“¤ê¸° (bucket=libraryë¡œ ìƒì„± ëª¨ë‹¬) %>
  <%= link_to t("coupon_templates.actions.new_in_library", default: "ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ìƒˆë¡œ ë§Œë“¤ê¸°"),
      new_coupon_template_path(bucket: "library"),
      data: { turbo_frame: "modal" },
      class: "px-3 py-1 bg-blue-600 text-white rounded" %>
</div>

<table class="w-full text-sm">
  <thead>
    <tr class="text-left text-gray-600">
      <th class="py-2"><%= t("coupon_templates.columns.title", default: "ì œëª©") %></th>
      <th><%= t("coupon_templates.columns.weight", default: "ê°€ì¤‘ì¹˜") %></th>
      <th><%= t("coupon_templates.columns.active", default: "ì‚¬ìš©") %></th>
      <th class="text-right"><%= t("ui.actions", default: "ìž‘ì—…") %></th>
    </tr>
  </thead>

  <tbody>
    <% templates.each do |tpl| %>
      <tr class="border-t">
        <td class="py-2">
          <div class="font-medium"><%= tpl.title %></div>
        </td>

        <td><%= tpl.weight %></td>

        <td>
          <%# on/off í…ìŠ¤íŠ¸ %>
          <span class="<%= tpl.active? ? 'text-green-700' : 'text-gray-500' %>">
            <%= tpl.active? ? t("ui.on", default: "ì¼œì§") : t("ui.off", default: "êº¼ì§") %>
          </span>
        </td>

        <td class="py-2">
          <div class="flex items-center justify-end gap-3">
            <%# (5) âœ… ê´€ë¦¬ìžë„ 'ê°€ì ¸ì˜¤ê¸°' ë²„íŠ¼: ë¼ì´ë¸ŒëŸ¬ë¦¬ í…œí”Œë¦¿ì„ ë‚´(personal) ë²„í‚·ìœ¼ë¡œ ì±„íƒ %>
            <%= button_to t("coupon_templates.actions.adopt", default: "ê°€ì ¸ì˜¤ê¸°"),
                adopt_coupon_template_path(tpl),
                method: :post,
                form: { data: { disable_with: t("ui.processing", default: "ì²˜ë¦¬ì¤‘...") } },
                class: "underline" %>

            <%# ðŸ” í™œì„±/ë¹„í™œì„± í† ê¸€ (PATCHë¡œ ê°€ì •). ë¼ìš°íŠ¸ ì´ë¦„ ë‹¤ë¥´ë©´ ìˆ˜ì • %>
            <%= button_to(
                  (tpl.active? ? t("coupon_templates.actions.deactivate", default: "ë¹„í™œì„±") :
                                 t("coupon_templates.actions.activate",   default: "í™œì„±")),
                  toggle_active_coupon_template_path(tpl), # â† ë¼ìš°íŠ¸ ì´ë¦„ í”„ë¡œì íŠ¸ì— ë§žê²Œ ì¡°ì •
                  method: :patch,
                  form: { data: { disable_with: t("ui.processing", default: "ì²˜ë¦¬ì¤‘...") } },
                  class: "underline"
                ) %>

            <%# âœï¸ íŽ¸ì§‘(ëª¨ë‹¬ë¡œ ì—´ê¸°) %>
            <%= link_to t("ui.edit", default: "íŽ¸ì§‘"),
                edit_coupon_template_path(tpl),
                data: { turbo_frame: "modal" },
                class: "underline" %>

            <%# ðŸ—‘ ì‚­ì œ(í™•ì¸ ëª¨ë‹¬) %>
            <%= button_to t("ui.delete", default: "ì‚­ì œ"),
                coupon_template_path(tpl),
                method: :delete,
                form: {
                  data: {
                    turbo_confirm: t("coupon_templates.confirm.delete",
                                     default: "ì •ë§ ì‚­ì œí• ê¹Œìš”? ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
                  }
                },
                class: "text-red-600 underline" %>
          </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
