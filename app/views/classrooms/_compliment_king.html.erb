<%# locals: (compliment_kings:, compliment_king_count:, classroom:) %>
<% if compliment_kings.present? && compliment_king_count.to_i.positive? %>
  <div class="mb-6 p-4 bg-yellow-100 rounded-lg text-center shadow">
    <span class="text-2xl">오늘의 칭찬왕</span>
    <br />

    <% compliment_kings.each do |king| %>
      <div class="mt-2 flex items-center justify-center gap-3">

        <span class="font-bold text-lg"><%= king.name %></span>

        <%# 교사/관리자일 때만 발급 버튼 노출 %>
        <% if policy(classroom).draw_coupon? %>
          <%= button_to t('ui.buttons.issue_coupon'),
                draw_coupon_classroom_path(
                  classroom,
                  basis: "daily",
                  mode: "daily_top",
                  user_id: king.id
                ),
                method: :post,
                form: {
                  data: {
                    controller: "disable-on-submit",
                    action: "turbo:submit-start->disable-on-submit#onSubmit turbo:submit-end->disable-on-submit#enable",
                    turbo_submits_with: t("ui.processing") 
                  },
                  aria: { busy: "false" }
                },
                class: "px-2 py-1 bg-amber-300 rounded hover:bg-amber-400 text-sm" %>
        <% end %>
      </div>

    <% end %>


    <div class="mt-2 text-sm text-gray-600">
      <%= compliment_king_count %>회 칭찬 받음
    </div>
  </div>
<% else %>
  <div class="mb-6 text-gray-400 text-center"><%= t('empty.today_king') %></div>
<% end %>