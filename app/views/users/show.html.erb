<% if @classroom %>
  <%= link_to t("ui.buttons.back_to_classroom", name: @classroom.name),
              classroom_path(@classroom),
              class: "inline-block bg-gray-200 px-4 py-2 rounded mb-4" %>
<% end %>

<% if @classroom && policy(@classroom).draw_coupon? %>
  <div class="my-4">
    <%= button_to t("ui.buttons.issue_coupon_manual"),
          draw_coupon_classroom_path(
            @classroom,          # 이미 users#show에서 @classroom 세팅되어 있다면 OK
            basis: "manual",
            mode:  "default",
            user_id: @user.id
          ),
          method: :post,
          form: { data: { turbo_submits_with: t("ui.processing") } },
          class: "px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm" %>
  </div>
<% end %>

<h3 class="mt-6 mb-2 font-semibold">
  <%= t("titles.recent_issued_coupons_for_user", default: "최근 발급 쿠폰") %>
</h3>
<%= turbo_frame_tag dom_id(@user, :recent_issued_coupons) do %>
  <%= render partial: "user_coupons/issued_coupons",
    locals: { coupons: @recent_issued_coupons, show_user: false } %>
<% end %>

<br/>

<h2><%= @user.name %>의 칭찬 내역</h2>
<ul>
  <% @compliments.each do |c| %>
    <li>
      <%= c.giver.name %> 선생님이
      <%= c.classroom.name if c.classroom %>에서
      <%= c.given_at.strftime("%Y-%m-%d %H:%M") %>에 칭찬!
    </li>
  <% end %>
</ul>

<%= turbo_frame_tag dom_id(@user, :coupons) do %>
  <%= render partial: "user_coupons/list", locals: { coupons: @coupons, user: @user } %>
<% end %>